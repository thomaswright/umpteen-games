// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Card from "../Card.res.mjs";
import * as Core__Array from "@rescript/core/src/Core__Array.res.mjs";

function pileValidation(dragPile, f) {
  return Core__Array.reduce(dragPile.toReversed(), [
                true,
                undefined
              ], (function (param, onBottom) {
                  if (!param[0]) {
                    return [
                            false,
                            undefined
                          ];
                  }
                  var onTop = param[1];
                  if (onTop !== undefined) {
                    return [
                            f(onBottom, onTop),
                            onBottom
                          ];
                  } else {
                    return [
                            true,
                            onBottom
                          ];
                  }
                }))[0];
}

function decAndAltValidation(dragPile) {
  return pileValidation(dragPile, (function (onTop, onBottom) {
                if (Card.rankIsAbove(onBottom, onTop)) {
                  return Card.color(onTop) !== Card.color(onBottom);
                } else {
                  return false;
                }
              }));
}

function decValidation(dragPile) {
  return pileValidation(dragPile, (function (onTop, onBottom) {
                if (Card.rankIsAbove(onBottom, onTop)) {
                  return onTop.card.suit === onBottom.card.suit;
                } else {
                  return false;
                }
              }));
}

function decCyclicValidation(dragPile) {
  return pileValidation(dragPile, (function (onTop, onBottom) {
                if (Card.rankIsAboveCyclic(onBottom, onTop)) {
                  return onTop.card.suit === onBottom.card.suit;
                } else {
                  return false;
                }
              }));
}

export {
  pileValidation ,
  decAndAltValidation ,
  decValidation ,
  decCyclicValidation ,
}
/* Card Not a pure module */
