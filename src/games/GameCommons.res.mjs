// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Card from "../Card.res.mjs";
import * as Core__Array from "@rescript/core/src/Core__Array.res.mjs";

function decAndAltValidation(dragPile) {
  return Core__Array.reduce(dragPile.toReversed(), [
                true,
                undefined
              ], (function (param, onBottom) {
                  if (!param[0]) {
                    return [
                            false,
                            undefined
                          ];
                  }
                  var onTop = param[1];
                  if (onTop !== undefined) {
                    return [
                            Card.rankIsBelow(onTop, onBottom) && Card.color(onTop) !== Card.color(onBottom),
                            onBottom
                          ];
                  } else {
                    return [
                            true,
                            onBottom
                          ];
                  }
                }))[0];
}

function decValidation(dragPile) {
  return Core__Array.reduce(dragPile.toReversed(), [
                true,
                undefined
              ], (function (param, onBottom) {
                  if (!param[0]) {
                    return [
                            false,
                            undefined
                          ];
                  }
                  var onTop = param[1];
                  if (onTop !== undefined) {
                    return [
                            Card.rankIsBelow(onTop, onBottom) && onTop.card.suit === onBottom.card.suit,
                            onBottom
                          ];
                  } else {
                    return [
                            true,
                            onBottom
                          ];
                  }
                }))[0];
}

export {
  decAndAltValidation ,
  decValidation ,
}
/* Card Not a pure module */
