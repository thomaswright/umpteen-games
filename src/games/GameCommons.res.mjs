// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Card from "../Card.res.mjs";
import * as Common from "../Common.res.mjs";
import * as Core__Array from "@rescript/core/src/Core__Array.res.mjs";

function pileValidation(dragPile, f) {
  return Core__Array.reduce(dragPile.toReversed(), [
                true,
                undefined
              ], (function (param, onBottom) {
                  if (!param[0]) {
                    return [
                            false,
                            undefined
                          ];
                  }
                  var onTop = param[1];
                  if (onTop !== undefined) {
                    return [
                            f(onBottom, onTop),
                            onBottom
                          ];
                  } else {
                    return [
                            true,
                            onBottom
                          ];
                  }
                }))[0];
}

function decAltColorValidation(dragPile) {
  return pileValidation(dragPile, (function (onBottom, onTop) {
                if (Card.rankIsAbove(onBottom, onTop)) {
                  return Card.color(onTop) !== Card.color(onBottom);
                } else {
                  return false;
                }
              }));
}

function decOneSuitValidation(dragPile) {
  return pileValidation(dragPile, (function (onBottom, onTop) {
                if (Card.rankIsAbove(onBottom, onTop)) {
                  return onTop.card.suit === onBottom.card.suit;
                } else {
                  return false;
                }
              }));
}

function decCyclicOneSuitValidation(dragPile) {
  return pileValidation(dragPile, (function (onBottom, onTop) {
                console.log(Card.rankIsAboveCyclic(onBottom, onTop));
                if (Card.rankIsAboveCyclic(onBottom, onTop)) {
                  return onTop.card.suit === onBottom.card.suit;
                } else {
                  return false;
                }
              }));
}

function decCyclicAnySuitValidation(dragPile) {
  return pileValidation(dragPile, (function (onBottom, onTop) {
                console.log(Card.rankIsAboveCyclic(onBottom, onTop));
                return Card.rankIsAboveCyclic(onBottom, onTop);
              }));
}

function flipLastUp(piles) {
  return piles.map(function (pile) {
              return Common.ArrayAux.updateLast(pile, (function (v) {
                            return {
                                    card: v.card,
                                    hidden: false
                                  };
                          }));
            });
}

export {
  pileValidation ,
  decAltColorValidation ,
  decOneSuitValidation ,
  decCyclicOneSuitValidation ,
  decCyclicAnySuitValidation ,
  flipLastUp ,
}
/* Card Not a pure module */
